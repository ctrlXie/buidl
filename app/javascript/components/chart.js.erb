const createChart = (id, argChartData, argChartLabels) => {
  var ctx = document.getElementById("product-chart-");

  let chartData = argChartData;
  let chartLabels = argChartLabels;
  console.log("creating chart");

  var ctx = document.getElementById(`product-chart-${id}`).getContext('2d');


  var myChart = new Chart(ctx, {
      type: 'pie',
      data: {
          labels: chartLabels,
          datasets: [{
              label: '# of Votes',
              data: chartData,
              backgroundColor: [
                '#3C4CA3',
                '#6C83FF',
                '#B5C1FF',
                '#34418C',
                '#5E77FF',
                '#A7B4FF',
                '#2B3774',
                '#566DE8',
                '#98A8FF',
                '#232C5D',
                '#4D62D1',
                '#899CFF',
                '#4557BA',
                '#7B8FFF',
                '#C4CDFF'
              ],
              borderColor: [
                  'rgba(255,255,255,0.8)',
                  'rgba(255,255,255,0.8)',
                  'rgba(255,255,255,0.8)',
                  'rgba(255,255,255,0.8)',
                  'rgba(255,255,255,0.8)',
                  'rgba(255,255,255,0.8)'
              ],
              borderWidth: 3
          }]
        },

    options: {
        legend: {
            display: true,
            position: "bottom",
            labels: {
                boxWidth: 12,
            }
        }
}
  });
}




const generateCharts = () => {

  const productCharts = document.querySelectorAll(".js-product-chart");



  productCharts.forEach((productChart) => {

    let id = productChart.dataset.projectid;
    console.log("productChart");

    console.log(typeof productChart.dataset.chartlabeldata);
    console.log(productChart.dataset.chartlabeldata);
    let string = productChart.dataset.chartlabeldata;
    let jsObj = JSON.parse(string);
    console.log(jsObj);

    let chartData = Object.values(jsObj);
    let chartLabels = Object.keys(jsObj);
    console.log(chartLabels);
    console.log(chartData);
    // let chartLabels = productChart.dataset.chartlabel;
    createChart(id, chartData, chartLabels);

  });

}

generateCharts()

export { createChart };
